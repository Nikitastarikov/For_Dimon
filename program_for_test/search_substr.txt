' Поиск подстроки в строке - алгоритм Бойера-Мура
Dim i as Integer
DIM j as Integer
DIM k as Integer
DIM needle_len as integer
DIM haystack_len as integer
DIM needle as string ' искомая подстрока
DIM haystack as string ' строка
DIM result as integer ' Номер позиции вхождения подстроки
DIM needle_table( 0 to 255) as integer ' Таблица смещений

needle="ark"
haystack="arururuurarklampa"
needle_len = len(needle)
haystack_len = len(haystack)
print needle_len
print haystack_len

if needle_len < haystack_len then

	for i = 0 to 255
		needle_table(i) = needle_len
	next

	' Заполнение смещений для символов подстроки
	for i = 1 to needle_len-1
		needle_table(ASC(MID(needle,i,1))) = needle_len-i
	next

	i = needle_len
	j = i

	while (j > 0) and (i <= haystack_len)
		j = needle_len
		k = i

		while (j > 0) and MID(haystack,k,1) = MID(needle,j,1)
			k=k-1
			j=j-1
		wend

		i = i + needle_table(ASC(MID(haystack,i,1)))
	wend

	if k > haystack_len - needle_len then
		result = 0
	else
		result = k + 1
	endif

else
	result = 0
endif

print "Результат = "; result